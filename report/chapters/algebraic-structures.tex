\chapter{Algebraic Structures}

\section{Algebraic Theories}\label{sec:algebraic-theories}

\begin{definition}[algebraic theory]
  We define an algebraic theory $ T $ to be a sequence of sets $ T_n $ indexed over $ \mathbb N $ with for all $ 1 \leq i \leq n $ elements ("variables" or "projections") $ x_{n, i}: T_n $ (we usually leave $ n $ implicit), together with a substitution operation
  \[ \_ \bullet \_: T_m \times T_n^m \to T_n \]
  for all $ m, n $, such that
  \begin{align*}
    x_j \bullet g &= g_j\\
    f \bullet (x_{l, i})_i &= f\\
    (f \bullet g) \bullet h &= f \bullet (g_i \bullet h)_i
  \end{align*}
  for all $ 1 \leq j \leq l $, $ f: T_l $, $ g: T_m^l $ and $ h: T_n^m $.
\end{definition}

\begin{definition}[algebraic theory morphism]
  A morphism $ F $ between algebraic theories $ T $ and $ T^\prime $ is a sequence of functions $ F_n: T_n \to T^\prime_n $ (we usually leave the $ n $ implicit) such that
  \begin{align*}
    F_n(x_j) &= x_j\\
    F_n(f \bullet g) &= F_m(f) \bullet (F_n(g_i))_i
  \end{align*}
  for all $ 1 \leq j \leq n $, $ f: T_m $ and $ g: T_n^m $.
\end{definition}

\begin{remark}
  We can construct binary products of algebraic theories, with sets $ (T \times T^\prime)_n = T_n \times T^\prime_n $, variables $ (x_i, x_i) $ and substitution
  \[ (f, f^\prime) \bullet (g, g^\prime) = (f \bullet g, f^\prime \bullet g^\prime). \]
  In the same way, the category of algebraic theories has all limits.
\end{remark}

\section{Algebras}

\begin{definition}[algebra]
  An algebra $ A $ for an algebraic theory $ T $ is a set $ A $, together with an action
  \[ \bullet: T_n \times A^n \to A \]
  for all $ n $, such that
  \begin{align*}
    x_j \bullet a &= a_j\\
    (f \bullet g) \bullet a &= f \bullet (g_i \bullet a)_i
  \end{align*}
  for all $ j $, $ f: T_m $, $ g: T_n^m $ and $ a: A^n $.
\end{definition}

\begin{definition}[algebra morphism]
  For an algebraic theory $ T $, a morphism $ F $ between $ T $-algebras $ A $ and $ A^\prime $ is a function $ F: A \to A $ such that
  \[ F(f \bullet a) = f \bullet (F(a_i))_i \]
  for all $ f: T_n $ and $ a: A^n $.
\end{definition}

\begin{remark}
  The category of algebras has all limits. The set of a limit of algebras is the limit of the underlying sets.
\end{remark}

\begin{remark}
  Note that for an algebraic theory $ T $, the $ T_n $ are all algebras for $ T $, with the action given by $ \bullet $.
\end{remark}

\section{Presheaves}

\begin{definition}[presheaf]
  A presheaf $ P $ for an algebraic theory $ T $ is a sequence of sets $ P_n $ indexed over $ \mathbb N $, together with an action
  \[ \bullet: P_m \times T_n^m \to P_n \]
  for all $ m, n $, such that
  \begin{align*}
    t \bullet (x_{l, i})_i &= t\\
    (t \bullet f) \bullet g &= t \bullet (f_i \bullet g)_i
  \end{align*}
  for all $ t: P_l $, $ f: T_m^l $ and $ g: T_n^m $.
\end{definition}

\begin{definition}[presheaf morphism]
  For an algebraic theory $ T $, a morphism $ F $ between $ T $-presheaves $ P $ and $ P^\prime $ is a sequence of functions $ F_n: P_n \to P^\prime_n $ such that
  \[ F_n(t \bullet f) = F_m(t) \bullet f \]
  for all $ t: P_m $ and $ f: T_n^m $.
\end{definition}

We will write $ \Pshf T $ for the category of $ T $-presheaves and their morphisms.

\begin{remark}
  The category of presheaves has all limits. The $ n $th set $ \overline{P}_n $ of a limit $ \overline{P} $ of presheaves $ P_i $ is the limit of the $ n $th sets $ P_{i, n} $ of the presheaves in the limit diagram.
\end{remark}

\section{\texorpdfstring{$ \lambda $-}{lambda-}theories}

\begin{definition}[$ \lambda $-theory]
  A $ \lambda $-theory is an algebraic theory $ L $, together with sequences of functions $ \lambda_n: L_{n + 1} \to L_n $ and $ \rho_n: L_n \to L_{n + 1} $, such that
  \begin{align*}
    \lambda_m(f) \bullet h &= \lambda_n(f \bullet (h_1 \bullet (x_{n + 1, 1}, \dots, x_{n + 1, n}), \dots, h_m \bullet (x_{n + 1, 1}, \dots, x_{n + 1, n}), x_{n + 1, n + 1}))\\
    \rho_n(g \bullet h) &= \rho_m(g) \bullet (h_1 \bullet (x_{n + 1, 1}, \dots, x_{n + 1, n}), \dots, h_m \bullet (x_{n + 1, 1}, \dots, x_{n + 1, n}), x_{n + 1, n + 1})
  \end{align*}
  for all $ f: L_{m + 1} $, $ g: L_m $ and $ h: L_n^m $.
\end{definition}

\begin{definition}[$ \beta $- and $ \eta $-equality]
  We say that a $ \lambda $-theory $ L $ satisfies $ \beta $-equality (or that it is a $ \lambda $-theory with $ \beta $) if $ \rho_n \circ \lambda_n = \id{L_n} $ for all $ n $. We say that is satisfies $ \eta $-equality if $ \lambda_n \circ \rho_n = \id{L_{n + 1}} $ for all $ n $.
\end{definition}

\begin{definition}[$ \lambda $-theory morphism]
  A morphism $ F $ between $ \lambda $-theories $ L $ and $ L^\prime $ is an algebraic theory morphism $ F $ such that
  \begin{align*}
    F_n(\lambda_n(f)) &= \lambda_n(F_{n + 1}(f))\\
    \rho_n(F_n(g)) &= F_{n + 1}(\rho_n(g))
  \end{align*}
  for all $ f: L_{n + 1} $ and $ g: L_n $.
\end{definition}

\begin{remark}
  The category of lambda theories has all limits, with the underlying algebraic theory of a limit being the limit of the underlying algebraic theories.
\end{remark}

A $ \lambda $-theory algebra or presheaf is a presheaf for the underlying algebraic theory.

\section{Examples}

There is a lot of different examples of algebraic theories and their algebras. Some of these even turn out to be $ \lambda $-theories. In this section, we will discuss a couple of these.

\subsection{The free algebraic theory on a set}
\begin{example}
  Let $ S $ be a set. We can construct an algebraic theory $ F(S) $ by taking $ F(S)_n = S \sqcup \{ 1, \dots, n \} $ with projections $ x_i = i $ and substitution
  \begin{align*}
    i \bullet g &= g_i & s \bullet g &= s
  \end{align*}
  for $ i : \{ 1, \dots, n \} $ and $ s : S $.

  If we have a function $ f: S \to S^\prime $, we get a morphism $ F(f): F(S) \to F(S^\prime) $ given by
  \begin{align*}
    F(f)_n(i) &= i & F(f)_n(s) &= f(s)
  \end{align*}
  for $ i : \{ 1, \dots, n \} $ and $ s : S $.

  Also, $ F $ obviously respects the identity and substitution morphisms, so it is a functor.
\end{example}

Note that we have a forgetful functor $ (\cdot)_0 $ that sends a morphism of algebraic theories $ g: T \to T^\prime $ to the function $ f_0: T_0 \to T^\prime_0 $.

\begin{lemma}
  The algebraic theory $ F(S) $ defined above, is the free algebraic theory on the set $ S $.
\end{lemma}
\begin{proof}
  Let $ T $ be an algebraic theory. We have an equivalence
  \[ \AlgTh(F(S), T) \cong \SET(S, T_0), \]
  sending $ f: \AlgTh(F(S), T) $ to $ f_0: S = S \sqcup \emptyset \to T_0 $ (this is trivially natural in $ S $ and $ T $) and $ f: \SET(S, T_0) $ to the functions $ g_n: F(S)_n \to T_n $ given by
  \begin{align*}
    g_n(i) &= x_i & g_n(s) &= f(s) \bullet ().
  \end{align*}
\end{proof}

The proofs that $ F(S) $ is an algebraic theory and that $ F(f) $ and $ g $ are algebraic theory morphisms is an easy exercise in case distinction.

\begin{corollary}
  $ F(\emptyset) $ is the initial algebraic theory.
\end{corollary}
\begin{proof}
  For $ S = \emptyset $, the equivalence of hom-sets becomes
  \[ \AlgTh(F(\emptyset), T) \cong \SET(\emptyset, T_0) \]
  and the latter has exactly one element.
\end{proof}

\begin{lemma}
  The category $ \Alg{F(S)} $ is equivalent to the coslice category (\TODO) $ S \downarrow \SET $.
\end{lemma}
\begin{proof}
  \TODO
\end{proof}

$ F(\emptyset) $ is, in some sense, the smallest nontrivial algebraic theory. Then $ F(S) $ is the smallest nontrivial algebraic theory that has the elements of $ S $ as constants.

\subsection{The free \texorpdfstring{$ \lambda $}{lambda}-theory on a set}

Like with the free algebraic theory, we will construct the free $ \lambda $-theory as the smallest nontrivial $ \lambda $-theory (which is the $ \lambda $-calculus) with some additional constants.

Let $ S $ be a set. Consider the sequence of inductive types $ (\Lambda(S)_n)_n $ with the following constructors:
\begin{align*}
  \mathtt{Var}_n &: \{ 1, \dots, n \} \to \Lambda(S)_n;\\
  \mathtt{App}_n &: \Lambda(S)_n \to \Lambda(S)_n \to \Lambda(S)_n;\\
  \mathtt{Abs}_n &: \Lambda(S)_{n + 1} \to \Lambda(S)_n;\\
  \mathtt{Con}_n &: S \to \Lambda(S)_n.\\
\end{align*}

Define a substitution operator $ \bullet: \Lambda(S)_m \times \Lambda(S)_n^m \to \Lambda(S)_n $ by induction on the first argument:
\begin{align*}
  \mathtt{Var}_m(i) \bullet g &= g_i;\\
  \mathtt{App}_m(a, b) \bullet g &= \mathtt{App}_n(a \bullet g, b \bullet g);\\
  \mathtt{Abs}_m(a) \bullet g &= \mathtt{Abs}_n(a \bullet ((g_i \bullet (x_{n + 1, j})_j)_i + (x_{n + 1})));\\
  \mathtt{Con}_m(s) \bullet g &= \mathtt{Con}_n(s).
\end{align*}

And then quotient $ \Lambda(S) $ by the relation generated by
\[ \mathtt{App}_m(\mathtt{Abs}_m(f), g) \sim f \bullet ((x_{n, i})_i + (g)) \]
for all $ f: \Lambda(S)_{n + 1} $ and $ g: \Lambda(S)_n $.

\begin{example}
  We can give the sequence of sets $ \Lambda(S) $ an algebraic theory structure with variables $ x_{m, i} = \mathtt{Var}_m(i) $ and the substitution operator $ \bullet $ defined above. We can give $ \Lambda(S) $ a $ \lambda $-theory structure with $ \beta $-equality by taking
  \[ \lambda_n(f) = \mathtt{Abs}_n(f) \quad \text{and} \quad \rho_n(f) = \mathtt{App}_{n + 1}(f \bullet (\mathtt{Var}_{n + 1}(i))_i, \mathtt{Var}_{n + 1}(n + 1)). \]

  Now, given a function $ S \to S^\prime $, we define a morphism $ \LamTh(\Lambda(S), \Lambda(S^\prime)) $ by induction, sending $ \mathtt{Var}(i) $, $ \mathtt{App}(a, b) $ and $ \mathtt{Abs}(a) $ in $ \Lambda(S) $ to their corresponding elements in $ \Lambda(S^\prime) $ and sending $ \mathtt{Con}(s) $ to $ \mathtt{Con}(f(s)) $.
\end{example}

Note that, like with the previous example, we have a forgetful functor $ (\dot)_0: \LamTh \to \SET $.

\begin{lemma}
  $ \Lambda(S) $ is the free $ \lambda $-theory on $ S $.
\end{lemma}
\begin{proof}
  Let $ L $ be a $ \lambda $-theory. We have an equivalence
  \[ \LamTh(\Lambda(S), L) \cong \SET(S, L_0), \]
  sending $ f: \LamTh(\Lambda(S), L) $ to $ f_0 \vert_S: S \to L_0 $ (again, trivially natural in $ S $ and $ L $) and conversely, $ g: \SET(S, L_0) $ to the inductively defined $ f: \LamTh(\Lambda(S), L) $ given by
  \begin{align*}
    f(\mathtt{Var}(i)) &= x_i;\\
    f(\mathtt{App}(a, b)) &= \rho(f(a)) \bullet ((x_{n, i})_i + (b));\\
    f(\mathtt{Abs}(a)) &= \lambda(f(a));\\
    f(\mathtt{Con}(s)) &= g(s) \bullet ().
  \end{align*}
\end{proof}

The proofs that $ \Lambda(S) $ is indeed a $ \lambda $-theory and that $ \Lambda(f) $ and $ g $ are $ \lambda $-theory morphisms, mainly work by definition of $ \bullet $, $ \lambda $ and $ \rho $, by induction on the terms of $ \Lambda(S) $ and by invoking the properties of the $ \lambda $-theory $ L $.

\begin{corollary}
  The `pure' lambda calculus is the initial $ \lambda $-theory.
\end{corollary}
\begin{proof}
  If we take $ S = \emptyset $, $ \Lambda(\emptyset) $ is the lambda calculus, which we will call $ \Lambda $. We have, like with the free algebraic theory, that $ \Lambda(\emptyset) $ is the initial $ \lambda $-theory.
\end{proof}

\subsection{The free object algebraic theory}

\begin{example}
  Take a category $ C $, with a forgetful functor $ G: C \to \SET $ and a free functor $ F: \SET \to C $. Let $ \eta: \id \SET \Rightarrow F \bullet G $ be the unit of the adjunction and let $ \varphi: C(F(c), d) \cong \SET(c, G(d)) $ be the natural equivalence of homsets.

  We define an algebraic theory $ T $ with $ T_n = G(F(\{ 1, \dots, n \})) $, projections $ x_{n, i} = \eta_{\{1, \dots, n\}}(i) $. For the substitution, note that we take $ t_1, \dots, t_m: T_n $, so we have $ t: \{ 1, \dots, m \} \to G(F(\{ 1, \dots, n \})) $. We then take
  \[ s \bullet t = G(\varphi^{-1}(t))(s). \]

  Now, given an object $ c: C $, we can create a $ T $-algebra $ \alpha(c) $, with set $ G(c) $ and action
  \[ s \bullet t = G(\varphi^{-1}(t))(s). \]
  Also, given a morphism $ f: C(c, d) $. This gives a morphism $ G(f): \alpha(c) \to \alpha(d) $. Therefore, $ \alpha: C \to \Alg T $ is a functor.
\end{example}

The proofs that $ T $ is an algebraic theory, that $ G(c) $ is an algebra and that $ G(f) $ is an algebra morphism mainly rely on the fact that $ \varphi $ is natural.

So we have a functor from $ C $ to the category of $ T $-algebras. One can wonder whether there also is a functor the other way, or whether $ \alpha $ is even an equivalence. This is hard to characterize precisely, but in algebra, there is a broad class of examples where the functor is an equivalence, so where $ C $ is equivalent to $ \Alg T $. That is probably why $ T $ is called an \textit{algebraic theory}.

The idea is that if an object of $ C $ is a set, together with some operations between its elements, one can carefully choose some elements of $ T_0 $, $ T_1 $, $ T_2 $ etc., which act on an algebra like the specified operations.

\begin{example}
  For $ C $ the category of monoids, $ \alpha: C \to \Alg T $ is an adjoint equivalence.

  Note that $ T_n $ is the free monoid on $ n $ elements. Its elements can be viewed as strings $ (x_1 x_5 x_3 x_{18} \dots x_7) $ with the characters $ x_1, \dots, x_n $, with the $ x_i $ the generators of the monoid, acting as the projections of the algebraic theory.

  Let $ A $ be a $ T $-algebra. We can give $ A $ a monoid structure by taking, for $ a, b: A $,
  \[ a b = (x_1 x_2) \bullet (a, b) \]
  and unit element
  \[ 1 = () \bullet (). \]
  Then the laws like associativity follow from those laws on the monoid and from the fact that the action on the algebra commutes with the substitution:
  \[ a (b c) = (x_1 (x_2 x_3)) \bullet (a, b, c) = ((x_1 x_2) x_3) \bullet (a, b, c) = (a b) c. \]
  Note that if we take a monoid, turn it into a $ T $-algebra and then into a monoid again, we still have the same underlying set, and it turns out that the monoid operation and unit element are equal to the original monoid operation and unit element. Therefore, $ \alpha $ is essentially surjective. It is also fully faithful, since any $ T $-algebra morphism respects the action of $ T $, which makes it into a monoid morphism. Therefore, $ \alpha $ is an adjoint equivalence.
\end{example}

\begin{remark}
  In the same way, one can characterize groups, rings and $ R $-algebras (for $ R $ a ring) as algebras of some algebraic theory. On the other hand, one can not use this method to describe fields as algebras for some theory $ T $, because one would need to describe the inverse $ z \mapsto z^{-1} $ operation as $ t \bullet (z) $ for some $ t: T_1 $, with $ z z^{-1} = 1 $, but since the elements of the algebraic theory act on all (combinations of) elements of the algebra, one would be able to take the inverse $ 0^{-1} = t \bullet (0) $ with $ 0 0^{-1} = 1 $, which would make no sense.
\end{remark}

\begin{remark}
  Another counterexample is the category $ \mathbf{Top} $ of topological spaces. We have a forgetful functor $ G: \mathbf{Top} \to \SET $ that just forgets the topology. On the other hand, we have a free functor $ F: \SET \to \mathbf{Top} $ which endows a set with the discrete topology. In this case, one obtains the inital algebraic theory $ T_n = \{ 1, \dots, n \} $, with an algebra action on every topological space $ i \bullet (a_1, \dots, a_n) = a_i $. Now, note that we can endow the set $ \{ \top, \bot \} $ with four different, nonisomorphic topologies, which all yield the same $ T $-algebra; the $ T $-algebra structure does not preserve the topological information. Therefore, the functor $ \alpha: \mathbf{Top} \to \Alg T $ is not an equivalence.
\end{remark}

\subsection{The terminal theory}
\begin{example}
  We can create a (somewhat trivial) algebraic theory $ T $ by taking $ T_n = \{ \star \} $, with projections $ x_i = \star $ and substitution $ \star \bullet \star = \star $. Taking $ \lambda(\star) = \star $ and $ \rho(\star) = \star $, we give it a $ \lambda $-theory structure (with $ \beta $ and $ \eta $-equality). Checking that this is indeed an algebraic theory and even a $ \lambda $-theory is trivial.

  Now, given any other algebraic theory $ T^\prime $, there exists a unique function $ T^\prime_n \to T_n $ for every $ n $, sending everything to $ \star $. These functions actually constitute an algebraic theory morphism $ T^\prime \to T $. If $ T^\prime $ is a $ \lambda $-theory, the algebraic theory morphism is actually a $ \lambda $-theory morphism. Again, checking this is trivial.

  Therefore, $ T $ is the terminal algebraic theory and $ \lambda $-theory.
\end{example}

\begin{lemma}
  $ \{ \star \} $ is the only algebra of the terminal theory.
\end{lemma}
\begin{proof}
  Let $ A $ be a $ T $-algebra. First of all, we have an element $ \star_A = \star_T \bullet_{0} () $. Secondly, for all elements $ \star, \star^\prime: A $, we have
  \[ \star = x_1 \bullet (\star, \star^\prime) = \star \bullet (\star, \star^\prime) = x_2 \bullet (\star, \star^\prime) = \star^\prime. \]
  Therefore, $ A = \{ \star \} $, which allows exactly one possible $ T $-action:
  \[ \star \bullet (\star, \dots, \star) = \star. \]
\end{proof}

\subsection{The endomorphism theory}

\begin{definition}[Endomorphism theory]
  Suppose that we have a category $ C $ and an object $ X: C $, such that all powers $ X^n $ of $ X $ are also in $ C $.
  The endomorphism theory $ E(X) $ of $ X $ is the algebraic theory given by $ E(X)_n = C(X^n, X) $ with projections as variables $ x_{n, i}: X^n \to X $ and a substitution that sends $ f: X^m \to X $ and $ g_1, \dots, g_m: X^n \to X $ to $ f \circ \langle g_i \rangle_i: X^n \to X^m \to X $.
\end{definition}

\begin{definition}[Endomorphism $ \lambda $-theory]
  Now, suppose that the exponential object $ X^X $ exists, and that we have morphisms back and forth $ abs: X^X \to X $ and $ app: X \to X^X $. Let, for $ Y: C $, $ \varphi_Y $ be the isomorphism $ C(X \times Y, X) \xrightarrow{\sim} C(Y, X^X) $.
  We can give $ E(X) $ a $ \lambda $-theory structure by setting, for $ f: E(X)_{n + 1} $ and $ g: E(X)_n $,
  \[ \lambda(f) = abs \circ \varphi_{X^n}(f) \qquad \rho(g) = \varphi_{X^n}^{-1}(app \circ g). \]
\end{definition}

The proofs that $ E(X) $ is an algebraic theory and a $ \lambda $-theory, use properties of the product, and naturality of the isomorphism $ \varphi_Y $.

\subsection{The theory algebra}
\begin{example}
  Let $ T $ be an algebraic theory and $ n $ a natural number. We can endow the $ T_n $ with a $ T $-algebra structure, by taking the substitution operator of $ T $ as the $ T $-action. Since this commutes with the substitution operator and the projections, $ T_n $ is a $ T $-algebra.
\end{example}

\subsection{The theory presheaf}
\begin{example}
  Let $ T $ be an algebraic theory. We can endow $ T $ with a $ T $-presheaf structure, by taking the substitution operator of $ T $ as the action on $ T $. Since this commutes with the substitution operator and the projections, $ T $ is a $ T $-presheaf.
\end{example}

\begin{lemma}
  Given an algebraic theory $ T $ and a $ T $-presheaf $ Q $, we have for all $ n $ a bijection of sets
  \[ \varphi: \Pshf T(T^n, Q) \cong Q_n. \]
\end{lemma}
\begin{proof}
  For $ f: \Pshf T(T^n, Q) $, take $ \varphi(f) = f_n(x_1, \dots, x_n) $.

  Conversely, for all $ q: Q_n $ and all $ t_1, \dots, t_n: T_m^n $ take
  \[ \varphi^{-1}(q)_m(t_1, \dots, t_n) = q \bullet t. \]
\end{proof}

\subsection{The "+l" presheaf}

Let $ \iota_{m, n} : T_m \to T_{m + n} $ denote the function that sends $ f $ to $ f \bullet (x_{m + n, 1}, \dots, x_{m + n, m}) $. Note that
\[ \iota_{m, n}(f) \bullet g = f \bullet (g_i)_{i \leq m} \quad \text{and} \quad \iota_{m, n}(f \bullet g) = f \bullet (\iota_{m, n}(g_i))_i. \]

For tuples $ x : X^m $ and $ y: X^n $, let $ x + y $ denote the tuple $ (x_1, \dots, x_m, y_1, \dots, y_n) : X^{m + n} $.

\begin{example}[The `+l' presheaf]
  Given a $ T $-presheaf $ Q $, we can construct a presheaf $ A(Q, l) $ with $ A(Q, l)_n = Q_{n + l} $ and, for $ q: A(Q, l)_m $ and $ f: T_n^m $, action
  \[ q \bullet_{A(Q, l)} f = q \bullet_Q ((\iota_{n, l} (f_i))_i + (x_{n + i})_i). \]
\end{example}

\begin{lemma}
  For all $ l $ and $ T $-presheaves $ Q $, $ A(Q, l) $ is the exponential object $ Q^{T^l} $.
\end{lemma}
\begin{proof}
  We will show that $ A(-, l) $ constitutes a right adjoint to the functor $ - \times T^l $. We will do this using universal arrows.

  For $ Q $ a $ T $-presheaf, take the arrow $ \varphi: A(Q, l) \times T^l \to Q $ given by $ \varphi(q, t) = q \bullet_Q ((x_{n, i})_i + t) $ for $ q: A(Q, l)_n = Q_{n + l} $ and $ t: T^l_n $.

  Now, given a $ T $-presheaf $ Q^\prime $ and a morphism $ \psi: Q^\prime \times T^l \to Q $. Define $ \tilde \psi: Q^\prime_n \to A(Q, l)_n $ by $ \tilde \psi(q) = \psi(\iota_{n, l}(q), (x_{n + i})_i) $.

  Then $ \psi $ factors as $ \varphi \circ (\tilde \psi \times \id{T^l}) $. Also, some equational reasoning shows that $ \tilde \psi $ is unique, which proves that $ \varphi $ indeed is a universal arrow.
\end{proof}
