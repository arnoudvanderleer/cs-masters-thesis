\chapter{Weak Cartesian Closed Categories}
In Definition \ref{def:endomorphism-theory}, we defined the endomorphism $ \lambda $-theory of a reflexive object in a cartesian closed category. However, as it turns out, we do not need all of the properties of a cartesian closed category. It suffices to consider a \textit{weak} cartesian closed category. In fact, even a `semi cartesian closed category' will suffice, but in this section, we will restrict ourselves to a weak cartesian closed category, as this notion suits our purposes well enough.

It seems that semi cartesian closed categories were first defined in \cite{hayashi-1985-semifunctors} and then \cite{hoofman-1993-semi-cartesian-closed} gave a slightly different definition, as well as the very related definition of a weak cartesian closed category. The latter paper also contains the construction of the endomorphism $ \lambda $-theory.

\begin{definition}
  Let $ C $ be a category with binary products (we will call the projections $ \pi_1 $ and $ \pi_2 $), and take $ A, B : C $. A \iindex{semi-exponential object} is an object $ A^B : C $, with a morphism $ \mathrm{ev}: C(A^B \times B \to A) $ and a hayashi-1985-semifunctorsfunction
  \[ \mathrm{cur}_X: C(X \times B \to A) \to C(X, A^B) \]
  for all $ X $, such that
  \[ \langle g \cdot \mathrm{cur}_X(f), h \rangle \cdot \mathrm{ev} = \langle g, h \rangle \cdot f \quad \text{and} \quad \mathrm{cur}_Y((g \times \id B) \cdot f) = g \cdot \mathrm{cur}_X(f) \]
  for all $ f: C(X \times B, A) $, $ g : C(Y, X) $ and $ h : C(Y, B) $.
\end{definition}

\begin{definition}
  A \textit{weak cartesian closed category}\index{cartesian closed category!weak} is a category $ C $ with a terminal object and binary products, together with a choice for a semi-exponential object $ A^B $ for all $ A, B : C $.
\end{definition}

\begin{definition}
  Let $ C $ a weak cartesian closed category. A \iindex{reflexive object} in $ C $ is an object $ U $ with morphisms $ f $ and $ g $, forming the following commutative diagram:
  \begin{center}
    \begin{tikzcd}
      U^U \arrow[dd, "\mathrm{cur}_{U^U}(\mathrm{ev})"'] \arrow[rd, "f"]\\
      & U \arrow[ld, "g"]\\
      U^U
    \end{tikzcd}
  \end{center}
\end{definition}

\begin{definition}
  If we have a reflexive object $ (U, f, g) $ in a weak cartesian closed category $ C $, we can endow the endomorphism algebraic theory $ E_C(U) $ (Definition \ref{def:endomorphism-theory}) with a $ \lambda $-theory structure with $ \beta $-equality, with
  \[ \rho(s) = ((s \cdot g) \times \id U) \cdot \mathrm{ev} : C(U^{n + 1}, U) \]
  and
  \[ \lambda(t) = \mathrm{cur}_{U^n}(t) \cdot f : C(U^n, U) \]
  for $ s: E(U)_n $ and $ t: E(U)_{n + 1} $.
\end{definition}

\begin{lemma}
  The definition above indeed yields a $ \lambda $-theory with $ \beta $-equality.
\end{lemma}
\begin{proof}
  We have
  \begin{align*}
    \rho(s \bullet t)
    &= ((\langle t_i \rangle_i \cdot (s \cdot g)) \times \id U) \cdot \mathrm{ev}\\
    &= (\langle t_i \rangle_i \times \id U) \cdot ((s \cdot g) \times \id U) \cdot \mathrm{ev}\\
    &= \rho(s) \bullet ((\iota_{n, 1}(t_i))_i + (x_{n + 1, n + 1})),
  \end{align*}
  \begin{align*}
    \lambda(s) \bullet t
    &= \langle t_i \rangle_i \cdot \mathrm{cur}(t) \cdot f\\
    &= \mathrm{cur}_{U^n}((\langle t_i \rangle_i \times \id U) \cdot t) \cdot f\\
    &= \lambda(s \bullet ((\iota_{n, 1}(t_i))_i + (x_{n + 1, n + 1})))
  \end{align*}
  and
  \begin{align*}
    \rho(\lambda(s))
    &= \langle \pi_1 \cdot \mathrm{cur}_{U^n}(t) \cdot \mathrm{cur}_{U^U}(\mathrm{ev}), \pi_2 \rangle \cdot \mathrm{ev}\\
    &= \langle \pi_1 \cdot \mathrm{cur}_{U^n}(t), \pi_2 \rangle \cdot \mathrm{ev}\\
    &= t.
  \end{align*}
\end{proof}

Now, we will show that the semi-exponential objects satisfy some properties that justify the use of the exponential notation. These properties allow us to construct semi-exponentials on products, from the semi-exponentials of their components.

\begin{lemma}
  Take $ A, A^\prime, B : C $. If $ A^B $ and $ {A^\prime}^B $ are semi-exponential objects, then $ A^B \times (A^\prime)^B $ is the semi-exponential object $ (A \times A^\prime)^B $.
\end{lemma}
\begin{proof}
  We have
  \begin{align*}
    \mathrm{ev} : C(A^B \times B \to A) \quad &\text{and} \quad \mathrm{ev}^\prime : C({A^\prime}^B \times B \to A^\prime),\\
    \mathrm{cur}_X: C(X \times B, A) \to C(X, A^B) \quad &\text{and} \quad \mathrm{cur}^\prime_X: C(X \times B, A^\prime) \to C(X, {A^\prime}^B).
  \end{align*}
  Define
  \[ \mathrm{ev}^{\prime \prime} = \langle \langle \pi_1 \cdot \pi_1, \pi_2 \rangle \cdot \mathrm{ev}, \langle \pi_1 \cdot \pi_2, \pi_2 \rangle \cdot \mathrm{ev} \rangle : C(A^B \times {A^\prime}^B, A \times A^\prime) \]
  and for $ f: C(X \times B, A \times A^\prime) $,
  \[ \mathrm{cur}^{\prime \prime}_X(f) = \langle \mathrm{cur}_X(f \cdot \pi_1), \mathrm{cur}_X(f \cdot \pi_2) \rangle : C(X, A^B \times A^{B^\prime}). \]
  These satisfy the required equations.
\end{proof}

\begin{lemma}
  Take $ A, B, B^\prime : C $. If $ A^B $ and $ (A^B)^{B^\prime} $ are semi-exponential objects, then $ (A^B)^{B^\prime} $ is the semi-exponential object $ A^{B \times B^\prime} $.
\end{lemma}
\begin{proof}
  We have
  \begin{align*}
    \mathrm{ev} : C(A^B \times B \to A) \quad &\text{and} \quad \mathrm{ev}^\prime : : C((A^B)^{B^\prime} \times B^\prime \to A^B),\\
    \mathrm{cur}_X: C(X \times B, A) \to C(X, A^B) \quad &\text{and} \quad \mathrm{cur}^\prime_X: C(X \times B^\prime, A^B) \to C(X, (A^B)^{B^\prime}).
  \end{align*}
  Define
  \[ \mathrm{ev}^{\prime \prime} = \langle (\id {(A^B)^{B^\prime}} \times \pi_2) \cdot \mathrm{ev}^\prime, \pi_2 \cdot \pi_1 \rangle \cdot \mathrm{ev} : C((A^B)^{B^\prime} \times (B \times B^\prime), A) \]
  and for $ f: C(X \times (B \times B^\prime), A) $,
  \[ \mathrm{cur}^{\prime \prime}_X(f) = \mathrm{cur}^\prime_X(\mathrm{cur}_{X \times B^\prime}(\langle \pi_1 \cdot \pi_1, \langle \pi_2, \pi_1 \cdot \pi_2 \rangle \rangle \cdot f)) : C(X, (A^B)^{B^\prime}). \]
  Then, for $ f: C(X \times (B \times B^\prime), A) $, $ g: C(Y, X) $ and $ h: C(Y, B \times B^\prime) $,
  \begin{align*}
    \langle g \cdot \mathrm{cur}^{\prime \prime}_X(f), h \rangle \cdot \mathrm{ev}^{\prime \prime}
    &= \langle \langle g \cdot \mathrm{cur}^\prime_X(\mathrm{cur}_{X \times B^\prime}(\langle \pi_1 \cdot \pi_1, \langle \pi_2, \pi_1 \cdot \pi_2 \rangle \rangle \cdot f)), h \cdot \pi_2 \rangle \cdot \mathrm{ev}^\prime, h \cdot \pi_1 \rangle \cdot \mathrm{ev}\\
    &= \langle \langle \langle g, h \cdot \pi_2 \rangle, h \cdot \pi_1 \rangle \cdot \pi_1 \cdot \pi_1, \langle \langle \langle g, h \cdot \pi_2 \rangle, h \cdot \pi_1 \rangle \cdot \pi_2, \langle \langle g, h \cdot \pi_2 \rangle, h \cdot \pi_1 \rangle \cdot \pi_1 \cdot \pi_2 \rangle \rangle \cdot f\\
    &= \langle g, h \rangle \cdot f
  \end{align*}
  and
  \begin{align*}
    \mathrm{cur}^{\prime \prime}_Y((g \times \id B) \cdot f)
    &= \mathrm{cur}^\prime_Y(\mathrm{cur}_{Y \times B^\prime}(((g \times \id{B^\prime}) \times \id B) \cdot \langle \pi_1 \cdot \pi_1, \langle \pi_2, \pi_1 \cdot \pi_2 \rangle \rangle \cdot f))\\
    &= \mathrm{cur}^\prime_Y((g \times \id{B^\prime}) \cdot \mathrm{cur}_{X \times B^\prime}(\langle \pi_1 \cdot \pi_1, \langle \pi_2, \pi_1 \cdot \pi_2 \rangle \rangle \cdot f))\\
    &= g \cdot \mathrm{cur}^\prime_X(\mathrm{cur}_{X \times B^\prime}(\langle \pi_1 \cdot \pi_1, \langle \pi_2, \pi_1 \cdot \pi_2 \rangle \rangle \cdot f)),\\
  \end{align*}
  which concludes the proof.
\end{proof}

Now, we can show that giving an algebraic theory a $ \lambda $-theory structure amounts to endowing its corresponding Lawvere theory (Lemma \ref{lem:lawvere-clone}) with a weak cartesian closed structure.
\begin{lemma}
  Let $ L $ be an algebraic theory. A weak cartesian closed category structure on its associated Lawvere theory gives a $ \lambda $-theory structure on $ L $.
\end{lemma}
\begin{proof}
  \TODO
\end{proof}

\begin{lemma}
  Let $ L $ be a $ \lambda $-theory. Then its corresponding Lawvere theory $ C $ is a weak cartesian closed category.
\end{lemma}
\begin{proof}
  Note that by definition of a Lawvere theory, every $ n: C $ is the $ n $-fold product of $ 1 $. Therefore, binary products are given by addition on the natural numbers, and $ 0 $ is the terminal object.

  \TODO
\end{proof}
